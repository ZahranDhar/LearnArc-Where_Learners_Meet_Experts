<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Profile Page - LearnArc</title>
  <link rel="stylesheet" href="../static/css/profile.css"/>
</head>
<body>

  <header>
    <div class="logo">
      <img src="../static/webimages/learnarc.jpg" alt="LearnArc Logo"/>
    </div>
    <nav class="main-nav">
      <a href="../templates/Home.html" data-i18n-key="home">Home</a>
      <a href="#" style="background-color: dodgerblue; color: white;" data-i18n-key="profile" class="active">Profile</a>
      <a href="#" data-i18n-key="chats">Chats</a>
      <a href="../templates/search.html" data-i18n-key="search">Search</a>
      <a href="#" style="margin-left: 450px;" data-i18n-key="aboutUs">About Us</a>
      <a href="#" data-i18n-key="contact">Contact</a>
    </nav>
  </header>

  <div class="profile-container">
    <aside class="left-sidebar">
      <button class="active" data-i18n-key="myProfile">My Profile</button>
      <ul>
        <li><a href="../templates/change_password.html" data-i18n-key="changePwd">Change Password</a></li>
        <li>
          <label data-i18n-key="language">Language:</label>
          <select id="languageSelect">
            <option value="en">English</option>
            <option value="hi">हिन्दी</option>
          </select>
        </li>
        <li><a href="#" data-i18n-key="privacy">Privacy</a></li>
        <li><a href="#" data-i18n-key="help">Help</a></li>
        <li><a href="#" data-i18n-key="logout">Logout</a></li>
      </ul>
      <button type="button" onclick="openModal()" class="delete-account-btn" data-i18n-key="deleteAcct">Delete Account</button>

      <div id="deleteModal" class="modal">
        <div class="modal-content">
          <span class="close" onclick="closeModal()">&times;</span>
          <h2 data-i18n-key="deleteTitle">Delete Account</h2>
          <p data-i18n-key="deleteConfirm">Are you sure you want to delete your account? This action cannot be undone.</p>
          <div class="modal-buttons">
            <button type="button" class="cancel-btn" data-i18n-key="cancelBtn" onclick="closeModal()">Cancel</button>
            <button type="button" class="delete-btn" data-i18n-key="confirmBtn" onclick="confirmDelete()">Delete</button>
          </div>
        </div>
      </div>
    </aside>

    <main class="profile-main">
      <div class="profile-header">
        <div class="avatar"></div>
        <div class="userinfo">
          <h2 data-i18n-key="username">Username</h2>
          <p data-i18n-key="niche">Niche</p>
        </div>
        <a href="#" class="edit-profile" data-i18n-key="editProfile">Edit Profile</a>
      </div>

      <section class="personal-info">
        <h3 data-i18n-key="personalInfo">Personal Information</h3>
        <div class="row">
          <label><b data-i18n-key="firstNameLabel">First name:</b></label>
          <input type="text" readonly value="BEHZAD"/>
          <label><b data-i18n-key="lastNameLabel">Last name:</b></label>
          <input type="text" readonly value="AYOUB"/>
          <label><b data-i18n-key="ageLabel">Age:</b></label>
          <input type="text" readonly value="20"/>
        </div>

        <section class="expertise-section">
  <h3 data-i18n-key="expertiseAreas">Expertise Areas</h3>
  <div id="expertise-container"></div>
  <button type="button" id="addExpertiseBtn" data-i18n-key="addExpertise">+ Add Expertise</button>
</section>

    </main>
  </div>

  <script>
    // Translation map
    const translations = {
      en: { home: "Home", profile: "Profile", chats: "Chats", search: "Search", aboutUs: "About Us", contact: "Contact",
        myProfile: "My Profile", changePwd: "Change Password", language: "Language:", privacy: "Privacy", help: "Help", logout: "Logout",
        deleteAcct: "Delete Account", deleteTitle: "Delete Account",
        deleteConfirm: "Are you sure you want to delete your account? This action cannot be undone.",
        cancelBtn: "Cancel", confirmBtn: "Delete", username: "Username", niche: "Niche", editProfile: "Edit Profile",
        personalInfo: "Personal Information", firstNameLabel: "First name:", lastNameLabel: "Last name:", ageLabel: "Age:",
        expertiseAreas: "Expertise Areas", subjectLabel: "Subject:", topicLabel: "Topic:", descriptionLabel: "Description:",
        edit: "Edit", addExpertise: "+ Add Expertise"
      },
      hi: { home: "होम", profile: "प्रोफ़ाइल", chats: "चैट्स", search: "खोज", aboutUs: "हमारे बारे में", contact: "संपर्क",
        myProfile: "मेरी प्रोफ़ाइल", changePwd: "पासवर्ड बदलें", language: "भाषा:", privacy: "गोपनीयता",
        help: "सहायता", logout: "लॉगआउट", deleteAcct: "खाता हटाएं", deleteTitle: "खाता हटाएं",
        deleteConfirm: "क्या आप वाकई अपना खाता हटाना चाहते हैं? यह पूर्ववत नहीं हो सकता।",
        cancelBtn: "रद्द करें", confirmBtn: "हटाएं", username: "उपयोगकर्ता नाम", niche: "विशेषता",
        editProfile: "प्रोफ़ाइल संपादित करें", personalInfo: "व्यक्तिगत जानकारी",
        firstNameLabel: "पहला नाम:", lastNameLabel: "अंतिम नाम:", ageLabel: "उम्र:",
        expertiseAreas: "विशेषज्ञता क्षेत्र", subjectLabel: "विषय:", topicLabel: "विषय-वस्तु:", descriptionLabel: "विवरण:",
        edit: "संपादित करें", addExpertise: "विशेषज्ञता जोड़ें"
      }
    };

    function translatePage(lang) {
      document.querySelectorAll('[data-i18n-key]').forEach(el => {
        const key = el.getAttribute('data-i18n-key');
        el.textContent = translations[lang]?.[key] || el.textContent;
      });
    }

    const langSelect = document.getElementById('languageSelect');
    langSelect.addEventListener('change', () => translatePage(langSelect.value));
    translatePage(langSelect.value);

    // Delete modal
    function openModal() { document.getElementById('deleteModal').style.display = 'flex'; }
    function closeModal() { document.getElementById('deleteModal').style.display = 'none'; }
    function confirmDelete() {
      alert(translations[langSelect.value].deleteAcct + " ✓");
      closeModal();
    }
    window.addEventListener('click', e => { if (e.target.id === 'deleteModal') closeModal(); });

 let niches = JSON.parse(localStorage.getItem('niches') || '[]');
function saveNichesToStorage() {
  niches = Array.from(document.querySelectorAll('.expertise-item')).map(it => {
    const [sub, top, desc] = it.querySelectorAll('input, textarea');
    return { subject: sub.value, title: top.value, desc: desc.value, user: 'You' };
  });
  localStorage.setItem('niches', JSON.stringify(niches));
}

function bindExpertise(div, startEditing = false) {
  const fields = Array.from(div.querySelectorAll('input, textarea'));
  const [editBtn, saveBtn, deleteBtn] = div.querySelectorAll('.edit-btn, .save-btn, .delete-btn');

  function setMode(editMode) {
    fields.forEach(f => f.readOnly = !editMode);
    editBtn.style.display = editMode ? 'none' : 'inline-block';
    saveBtn.style.display = editMode ? 'inline-block' : 'none';
  }

  editBtn.onclick = () => setMode(true);
  saveBtn.onclick = () => {
    setMode(false);
    saveNichesToStorage();
  };
  deleteBtn.onclick = () => {
    div.remove();
    saveNichesToStorage();
  };

  setMode(startEditing);
}

const container = document.getElementById('expertise-container');
// Initialize existing entries
niches.forEach(n => {
  const div = document.createElement('div');
  div.className = 'expertise-item';
  div.innerHTML = `
    <div class="field-group"><label data-i18n-key="subjectLabel">Subject:</label><input type="text" value="${n.subject}"></div>
    <div class="field-group"><label data-i18n-key="topicLabel">Topic:</label><input type="text" value="${n.title}"></div>
    <div class="field-group"><label data-i18n-key="descriptionLabel">Description:</label><textarea>${n.desc}</textarea></div>
    <div class="expertise-controls">
      <button class="edit-btn" data-i18n-key="edit">Edit</button>
      <button class="save-btn" data-i18n-key="save">Save</button>
      <button class="delete-btn" data-i18n-key="deleteExpertise">Delete</button>
    </div>`;
  container.appendChild(div);
  bindExpertise(div);
});

// Add new item, start in save/edit controls visible
document.getElementById('addExpertiseBtn').onclick = () => {
  const div = document.createElement('div');
  div.className = 'expertise-item';
  div.innerHTML = `
    <div class="field-group"><label data-i18n-key="subjectLabel">Subject:</label><input type="text" placeholder="Subject"></div>
    <div class="field-group"><label data-i18n-key="topicLabel">Topic:</label><input type="text" placeholder="Topic"></div>
    <div class="field-group"><label data-i18n-key="descriptionLabel">Description:</label><textarea placeholder="Description"></textarea></div>
    <div class="expertise-controls">
      <button class="edit-btn" style="display:none;" data-i18n-key="edit">Edit</button>
      <button class="save-btn" data-i18n-key="save">Save</button>
      <button class="delete-btn" data-i18n-key="deleteExpertise">Delete</button>
    </div>`;
  container.appendChild(div);
  bindExpertise(div, true);
};

  </script>

</body>
</html>
